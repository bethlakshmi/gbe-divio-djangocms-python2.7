{% extends 'base.tmpl' %}
{% load staticfiles sekizai_tags %}

{% block title %}
  Volunteer Signup
{% endblock %}

{% block head %}
    <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.10/css/jquery.dataTables.css">
{% endblock %}
{% block content %}
<div>
  <h2>Volunteer for {{ conference }}</h2>
  <div>{{ instructions | safe }}</div><br>
  <div>
    Toggle column(s):
    <a class="toggle-vis" id="gbe-table-select" data-column="1">
	Name</a> -
      <a class="toggle-vis" id="gbe-table-select" data-column="2">
	Start</a> -
      <a class="toggle-vis" id="gbe-table-select" data-column="3">
	End</a> -
      <a class="toggle-vis" id="gbe-table-select" data-column="4">
	Area</a>
  </div>
  <div>
  <form action="{% url 'gbe:volunteer_signup' %}" method="post">
    {% csrf_token %}
    <input type='hidden' id="id_accepted" name="accepted" value="3">
    <table id="volunteer_signup" class="order-column table table-bordered" cellspacing="0" width="100%">
      <thead>
        <tr class="bid-table">
            <th class="bid-table">&nbsp;</th>
            <th class="bid-table">Name</th>
            <th class="bid-table">Start</th>
            <th class="bid-table">End</th>
            <th class="bid-table">Area</th>
        </tr>
      </thead>
      <tfoot>
        <tr class="bid-table">
            <th class="bid-table">&nbsp;</th>
            <th class="bid-table">Name</th>
            <th class="bid-table">Start</th>
            <th class="bid-table">End</th>
            <th class="bid-table">Area</th>
        </tr>
      </tfoot>
      <tbody>
        {% for opportunity in volunteer_opps %}
        <tr class="bid-table {% if opportunity.booked and opportunity.occurrence.approval_needed%}info{% elif opportunity.booked %}success{% endif %}">
            <td class="bid-table">
              <input id="id_events_{{ forloop.counter0 }}"
                name="events" type="checkbox" value="{{opportunity.occurrence.pk}}"
                {% if opportunity.booked %}checked="checked"{% endif %}/>
            </td>
            <td class="bid-table">
                {{opportunity.eventitem}}
                {% if opportunity.eventitem.child.e_description %}
                &nbsp;<span class="dropt" title="Info">
                  <i class="fas fa-info-circle"></i>
                  <span style="width:200px;float:right;text-align:left;">
                  {{opportunity.eventitem.child.e_description | safe}}
                  </span>
                </span>{% else %}
                {% for area in opportunity.staff_areas %}
                {% if area.description %}
                &nbsp;<span class="dropt" title="AreaInfo">
                  <i class="fas fa-info-circle"></i>
                  <span style="width:200px;float:right;text-align:left;">
                  {{area.description | safe}}
                  </span>
                </span>{% endif %}{% endfor %}{% endif %}
            </td>
            <td class="bid-table">{{opportunity.occurrence.start_time|date:_("SHORT_DATETIME_FORMAT") }}</td>
            <td class="bid-table">
            {{opportunity.occurrence.end_time|date:_("SHORT_DATETIME_FORMAT") }}</td>
            <td class="bid-table">
              {% if opportunity.parent_event %}
<a href="{% url 'scheduling:detail_view' opportunity.parent_event.eventitem.pk%}">
                {{opportunity.parent_event}}
              </a>
	            {% endif %}
              {% for area in opportunity.staff_areas %}
                {{area}}{% endfor %}
            </td>
        </tr>
        {% endfor%}
      </tbody>
    </table>
    <br><br>
    <input type="submit" value="Submit Form"> 
  </div>
</div>
</form>
{% addtoblock "js" %}
  <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
  <script>
  $(document).ready(function() {
    var table = $('#volunteer_signup').DataTable({
        "paging": false});

    $('a.toggle-vis').on( 'click', function (e) {
        e.preventDefault();

        // Get the column API object
        var column = table.column( $(this).attr('data-column') );

        // Toggle the visibility
        column.visible( ! column.visible() );
    } );
} );
  </script>
{% endaddtoblock %}
{% endblock %}
